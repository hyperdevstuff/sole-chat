{
  "active": true,
  "iteration": 1,
  "maxIterations": 20,
  "completionPromise": "COMPLETE",
  "prompt": "# Building Mode Prompt\n\nYou are in BUILDING MODE. Your job is to implement tasks from the plan, verify they work, and update the plan.\n\n## Phase 0: Orient (MANDATORY - Do These First)\n\n### 0a. Study Project Context\n```\nStudy AGENTS.md for conventions and anti-patterns.\nStudy specs/tooling.md for which tools to use.\n```\n\n### 0b. Study Current Plan\n```\nStudy IMPLEMENTATION_PLAN.md - find the highest priority incomplete task.\nThis is your focus. Do NOT skip ahead.\n```\n\n### 0c. Check Git State\n```\nRun: git status\nEnsure clean working directory before starting.\n```\n\n## Phase 1: Implement\n\n### Task Selection\nPick the FIRST incomplete task from Priority 1 in IMPLEMENTATION_PLAN.md.\n\n### Tool Usage\n\n**For UI/Visual Work (MANDATORY DELEGATION):**\n```\nDelegate to frontend-ui-ux-engineer agent:\n- TASK: [specific visual task from plan]\n- EXPECTED OUTCOME: [what it should look like/do]\n- REQUIRED SKILLS: frontend-design skill\n- REQUIRED TOOLS: Read, Write, Edit, Glob, Grep\n- MUST DO: \n  - Match existing dark theme\n  - Use TailwindCSS v4 patterns\n  - Follow component patterns in src/components/\n- MUST NOT:\n  - Change business logic\n  - Add new dependencies without approval\n  - Modify API endpoints\n- CONTEXT: [relevant file paths, existing patterns]\n```\n\n**For API/Logic Work:**\n- Use Context7 for Upstash/Elysia docs: `context7_resolve-library-id` â†’ `context7_query-docs`\n- Follow existing patterns in `src/app/api/[[...slugs]]/`\n\n**For E2E Testing:**\n```javascript\n// Playwriter pattern for 2-user chat testing\nconst user1 = await context.newPage();\nconst user2 = await context.newPage();\nawait user1.goto(roomUrl);\nawait user2.goto(roomUrl);\n// Test message sync, destruction, etc.\n```\n\n**For Debugging:**\n- Use Chrome DevTools MCP for network/console inspection\n- Use Playwriter for interactive debugging\n\n### Search Before Implementing\nUse up to 3 explore subagents to find:\n- Similar implementations to follow\n- Tests that need updating\n- Related code that might break\n\n## Phase 2: Verify\n\n### After Each Implementation:\n1. Run `bun build` to check types and build\n2. Run tests if they exist\n3. Use Playwriter for E2E verification if applicable\n4. Use Chrome DevTools to inspect network/console if debugging\n\n### Verification Checklist:\n- [ ] Code compiles (`bun build`)\n- [ ] Follows existing patterns (check AGENTS.md)\n- [ ] No type errors (`lsp_diagnostics`)\n- [ ] Acceptance criteria met (from specs/features.md)\n\n## Phase 3: Update Plan\n\nAfter completing a task:\n\n1. Mark task complete in IMPLEMENTATION_PLAN.md:\n```markdown\n- [x] Task description (commit: abc1234)\n```\n\n2. Add any discovered tasks:\n```markdown\n- [ ] New task found during implementation\n```\n\n3. Note blockers or issues:\n```markdown\n## Blocked\n- [ ] Task X waiting on Y\n```\n\n## Phase 4: Commit\n\nWhen tests pass and task is verified:\n```bash\ngit add -A\ngit commit -m \"feat: description of what was implemented\"\n```\n\nUse conventional commits:\n- `feat:` new feature\n- `fix:` bug fix\n- `refactor:` code change that neither fixes nor adds\n- `docs:` documentation only\n- `test:` adding tests\n- `chore:` maintenance\n\n## Guardrails (999...)\n\n9991. **Capture the why** - Add comments for non-obvious decisions\n9992. **Single sources of truth** - Don't duplicate, import\n9993. **Create git tags** - Tag significant milestones\n9994. **Extra logging** - Add debug logs when troubleshooting\n9995. **Keep plan current** - Update IMPLEMENTATION_PLAN.md after each task\n9996. **Update AGENTS.md** - Add operational learnings\n9997. **Resolve bugs** - Don't leave broken code\n9998. **Complete implementation** - No stubs, no TODOs in committed code\n9999. **Clean completed** - Remove done items from active plan sections\n\n## CRITICAL RULES\n\n1. **One task at a time** - Complete current before moving to next\n2. **Verify before committing** - All checks must pass\n3. **Update plan immediately** - Mark done right after completion\n4. **Delegate UI work** - Use frontend-ui-ux-engineer for visual changes\n5. **Use right tools** - Check specs/tooling.md for tool selection\n6. **Output completion signal** when task done: `<promise>COMPLETE</promise>`\n\n## Output Format\n\nAfter completing a task:\n\n```\n## Task Complete\n\n### What was done\n- Implemented X in file Y\n- Updated Z to support X\n\n### Verification\n- [x] bun build passed\n- [x] lsp_diagnostics clean\n- [x] Acceptance criteria verified\n\n### Commit\nfeat: add X feature (abc1234)\n\n### Next Task\n[First incomplete task from plan]\n\n<promise>COMPLETE</promise>\n```\n\n## Loop Behavior\n\nThis prompt runs in a loop. Each iteration:\n1. Check plan for next task\n2. Implement one task\n3. Verify and commit\n4. Update plan\n5. Signal complete\n\nThe loop continues until all Priority 1 and 2 tasks are done.\n",
  "startedAt": "2026-01-13T17:19:53.436Z",
  "model": "google/antigravity-claude-opus-4-5-thinking"
}